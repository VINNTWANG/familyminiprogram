<t-navbar title="照片墙" left-arrow />

<scroll-view
  scroll-y
  style="height: 100vh; box-sizing: border-box;"
  bindscrolltolower="onReachBottom"
  refresher-enabled="true"
  bindrefresherrefresh="onPullDownRefresh"
  refresher-triggered="{{isLoading}}"
  lower-threshold="300"
>
  <view class="photowall-container">
    <!-- Loading Skeleton -->
    <block wx:if="{{isLoading && images.length === 0}}">
      <view class="skeleton-loading">
        <view class="skeleton-item"></view>
        <view class="skeleton-item"></view>
      </view>
    </block>

    <!-- Waterfall Layout using pure CSS -->
    <block wx:else>
      <view class="waterfall-container">
        <view class="photo-card" wx:for="{{images}}" wx:key="src" bind:tap="onPhotoTap" data-postid="{{item.postId}}">
          <image src="{{item.src}}" mode="widthFix" lazy-load="true" />
        </view>
      </view>

      <!-- Load More / End of List -->
      <view class="list-footer">
        <t-loading wx:if="{{isLoading && images.length > 0}}" theme="spinner" text="加载中..." />
        <view wx:elif="{{!hasMore && images.length > 0}}" class="end-of-list">没有更多了</view>
      </view>
    </block>

    <!-- Empty State -->
    <view class="empty-state" wx:if="{{!isLoading && images.length === 0}}">
      <t-empty description="还没有任何动态发布过图片哦" />
    </view>
  </view>
</scroll-view>